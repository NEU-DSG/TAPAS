<?xml version="1.0" encoding="UTF-8" ?>
<config>
  <!-- NOTE: various comments and unused configuration possibilities have been purged
    from this file.  Please refer to 
    https://solr.apache.org/guide/solr/latest/configuration-guide/configuring-solrconfig-xml.html
    as well as the default solrconfig file included with Solr. -->

  <abortOnConfigurationError>${solr.abortOnConfigurationError:true}</abortOnConfigurationError>

  <!-- Controls what version of Lucene various components of Solr
      adhere to.  Generally, you want to use the latest version to
      get all bug fixes and improvements. It is highly recommended
      that you fully re-index after changing this setting as it can
      affect both how text is indexed and queried. -->
  <luceneMatchVersion>9.12</luceneMatchVersion>
  <!-- The DirectoryFactory to use for indexes.

       solr.StandardDirectoryFactory is filesystem
       based and tries to pick the best implementation for the current
       JVM and platform.  solr.NRTCachingDirectoryFactory, the default,
       wraps solr.StandardDirectoryFactory and caches small files in memory
       for better NRT performance.
    -->
  <directoryFactory name="DirectoryFactory"
                    class="${solr.directoryFactory:solr.NRTCachingDirectoryFactory}"/>

  <!-- Enables a transaction log, used for real-time get, durability, and
    and solr cloud replica recovery.  The log can grow as big as
    uncommitted changes to the index, so use of a hard autoCommit
    is recommended (see below).
    "dir" - the target directory for transaction logs, defaults to the
    solr data directory. -->
  <updateHandler class="solr.DirectUpdateHandler2">
    <updateLog>
      <str name="dir">${solr.ulog.dir:}</str>
    </updateLog>
    
    <!-- AutoCommit (automatic hard commit) 
      https://solr.apache.org/guide/solr/latest/indexing-guide/indexing-with-update-handlers.html -->
    <!--<autoCommit>
      <maxTime>${solr.autoCommit.maxTime:15000}</maxTime>
      <openSearcher>false</openSearcher>
    </autoCommit>-->
    
    <!-- softAutoCommit is like autoCommit except it causes a
      'soft' commit which only ensures that changes are visible
      but does not ensure that data is synced to disk.  This is
      faster and more near-realtime friendly than a hard commit. -->
    <!--<autoSoftCommit>
      <maxTime>${solr.autoSoftCommit.maxTime:3000}</maxTime>
    </autoSoftCommit>-->
  </updateHandler>

  <!-- We are using the manually-maintained schema.xml file.
    Since this solrconfig.xml file originally came from an older version of Solr, it's possible that we
    are using ClassicIndexSchemaFactory now because we've always used Solr that way. If we ever decide
    to investigate ManagedIndexSchemaFactory instead, this is where we'll make the change.
    See https://solr.apache.org/guide/solr/latest/configuration-guide/schema-factory.html for more
    information on options and migrating between factories. -->
  <schemaFactory class="ClassicIndexSchemaFactory"/>

  <dataDir>${solr.data.dir:}</dataDir>

  <requestHandler name="standard" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="echoParams">explicit</str>
      <str name="defType">lucene</str>
    </lst>
  </requestHandler>

  <searchComponent name="spellcheck" class="solr.SpellCheckComponent">
    <str name="queryAnalyzerFieldType">textSpell</str>
    <!-- Multiple "Spell Checkers" can be declared and used by this component
      (e.g. for title_spell field)
      -->
    <lst name="spellchecker">
      <str name="name">default</str>
      <str name="field">spell</str>
      <str name="spellcheckIndexDir">./spell</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">author</str>
      <str name="field">author_spell</str>
      <str name="spellcheckIndexDir">./spell_author</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">subject</str>
      <str name="field">subject_spell</str>
      <str name="spellcheckIndexDir">./spell_subject</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">title</str>
      <str name="field">title_spell</str>
      <str name="spellcheckIndexDir">./spell_title</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
  </searchComponent>

  <requestHandler name="/replication" class="solr.ReplicationHandler" startup="lazy" />

  <requestDispatcher handleSelect="true" >
    <requestParsers enableRemoteStreaming="true" multipartUploadLimitInKB="2048" />
  </requestDispatcher>

  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />
</config>
